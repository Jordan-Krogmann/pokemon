---
title: "Pokemon"
output: html_notebook
---

[![Mew](https://img.pokemondb.net/sprites/red-blue/normal/mew.png)](http://pokemondb.net/pokedex/mew)


# Set Up & Data Pull

Dev Needs

+ pull sprites 
  + https://pokemondb.net/sprites
  + https://veekun.com/dex/downloads
  
+ model
  + 
  

```{r load-packages , message=FALSE, warning=FALSE}
library(tidymodels)# tidy model framework
library(tidyverse) # plotting and data manipulation
library(DALEX)     # easy model interpretation
library(caret)     # model framework
library(gt)        # clean summary tablss
```

```{r data-pull, message=FALSE, warning=FALSE}
pokemon_df <- read_csv(
  "https://raw.githubusercontent.com/Jordan-Krogmann/pokemon/master/data/pokemon.csv"
  ) %>% 
  as_tibble() %>% 
  mutate(type2 = case_when(
    is.na(type2)~ "none",
    TRUE ~ type2
    )
  )
```

## EDA

To mimic their project I guess they use tree-based models to predict wether or not a Pokemon is legendary.

It seems they got legendary happy in the 7-generation of Pokemon... Not sure what games those are since I haven't played since *Pokemon Red*.

```{r generation-legendary, fig.align='center', fig.height=8, fig.width=12}
pokemon_df %>% 
    mutate(is_legendary = case_when(
      is_legendary == 1 ~ "Legendary",
      is_legendary == 0 ~ "Common"
  )) %>% 
  mutate(is_legendary = factor(x = is_legendary, levels = c("Legendary", "Common"))) %>% 
  group_by(generation, is_legendary) %>% 
  summarise(
    count_total = n(),
  ) %>% 
  ggplot(aes(x = as.factor(generation), y = count_total, fill = is_legendary)) + 
    geom_col(aes(), alpha = .7, color = "black") + 
    theme_minimal() + 
    theme(
      axis.text = element_text(face = "bold", size = 14),
      axis.title = element_text(face = "bold", size = 14),
      # axis.text.x = element_text(angle = 45, hjust = 1),
      plot.title = element_text(face = "bold", size = 16, hjust = .5),
      legend.position = c(.95,.9),
      legend.background = element_rect(color = "white")
      
    ) + 
    labs(
      title = "Count of Legendary Pokemon by Generation",
      y = "Count",
      x = "Generation"
    )
```


If you look at legendary count type one it looks like 
```{r plot-type-legendary, fig.align='center', fig.height=8, fig.width=12}
pokemon_df %>% 
  group_by(type1) %>% 
  summarise(
    count_total = n(),
    count_legendary = sum(is_legendary),
    percent_legendary = sum(is_legendary)/ n()
  ) %>% 
  ggplot(aes(x = reorder(type1, percent_legendary),y = percent_legendary))  +
    geom_col(aes(fill = type1), color = "black") + 
    scale_y_continuous(breaks = seq(0, .4, by = .1), labels = percent) +
    expand_limits(y = .4) + 
    theme_minimal() + 
    theme(
      axis.text = element_text(face = "bold", size = 14),
      axis.title = element_text(face = "bold", size = 14),
      axis.text.x = element_text(angle = 45, hjust = 1),
      plot.title = element_text(face = "bold", size = 16, hjust = .5),
      legend.position = "none"
    ) + 
    labs(
      title = "Percent of Legendary Pokemon by Type",
      # subtitle = "",
      y = "Percent",
      x = ""
    )
    
```

## Modeling

```{r modeling-data}
# training data frame
train_df <- pokemon_df %>% filter(generation != 7) %>% 
  select(
    -c(abilities, japanese_name , name, generation, percentage_male)
  ) 

# testing data frame
test_df <- pokemon_df %>% filter(generation == 7)%>% 
  select(
    -c(abilities, japanese_name , name, generation, percentage_male)
  )
```

```{r}
train_df %>% summary()
```


```{r model-recipe}
# model recipe
poke_recipe <- recipe(is_legendary ~ . , data = train_df)
```

```{r model-caret}
train(
  formula = is_legendary ~ .,
  na.action = na.pass,
  data = train_df,
  method = "rf"
)


```



